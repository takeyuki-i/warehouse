使用期限の近い製品をお知らせします。

<% @items.zip(@states).each do |item,state|%>
  <% if state.limit_id == 2 %>
    <% limit_day = state.limit_day.to_date %>
    <% alarm = limit_day - @today %>
    <% if alarm <= 10 && 0 <= alarm %>
      <%= "-------------------------------"%>
      <%= "Item：#{item.name}" %>
      <%= "ID: #{state.id}" %>
      <%= "残り日数:#{alarm.to_i}日"%>
      <%= "使用期限:#{state.limit_day.strftime("%Y年%m月%d日")}"%>
    <% else alarm < 0 %>
      <%= "-------------------------------"%>
      <%= "Item：#{item.name}" %>
      <%= "ID: #{state.id}" %>
      <%= "＊使用期限切れ＊:#{alarm.to_i}日"%>
      <%= "使用期限:#{state.limit_day.strftime("%Y年%m月%d日")}"%>
    <% end %>
  <% end %>
<% end %>
